<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://kit.fontawesome.com/83cece50f1.js" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" th:href="@{/static/assets/css/style.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/static/assets/css/home.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/static/assets/css/poll.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/static/assets/css/comment.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/static/assets/css/poll-buttom.css}">
    <link rel="stylesheet" href="../static/assets/css/search.css">
    <link rel="stylesheet" href="../static/assets/css/dropdown.css">
    <link rel="stylesheet" href="../static/assets/css/emoji.css">
    <link rel="stylesheet" href="../static/assets/css/loader.css">
    <link rel="stylesheet" type="text/css" th:href="@{/static/assets/css/singlechat.css}">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tributejs@5.1.3/dist/tribute.min.css">
    <style>


        /*for event */
        .align-self-center {
            margin-top: 37px;
        }
        #image-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.42); /* Black with opacity */
            transition: opacity 0.3s ease; /* Fade transition */
            opacity: 0; /* Initially hidden */
        }
        #image-modal1 {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.42); /* Black with opacity */
            transition: opacity 0.3s ease; /* Fade transition */
            opacity: 0; /* Initially hidden */
        }
        /* Close button */
        .close-modal {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #fff;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
        }

        .close-modal:hover,
        .close-modal:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
        @import url("https://fonts.googleapis.com/css?family=Roboto&display=swap");

        #groupId2 {
            appearance: none; /* Remove default arrow */
            -webkit-appearance: none; /* For older versions of Chrome and Safari */
            -moz-appearance: none; /* For older versions of Firefox */
            padding: 5px 10px; /* Add padding for better appearance */
            background-color: #ffffff; /* Set background color for non-image options */
            background-repeat: no-repeat;
            background-position: left center;
        }

        #groupId2 option {
            padding-left: 25px; /* Add padding for the text */
        }

        #groupId2 option[data-thumbnail] {
            background-image: url(attr(data-thumbnail)); /* Use 'attr' to access custom data attribute */
            background-size: 20px 20px; /* Adjust as needed */
        }
        .answer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .changeButton {
            margin-left: 10px; /* Adjust as needed */
        }

        .post {
            box-shadow: -2px -2px 5px #00000040,
            3px 3px 7px #00000040;
        }

        :root {
            --background-color: #a5bfd4;
            --header-color: #6a96d8;
            --send-color: #e6edf6;
            --received-color: #f2f2f2;
            --blocked-color: #ffc1c1;
            --light-gray: #dfdfdf;
            --dark-gray: #858a91;
        }

        .btn {
            opacity: 0.7;
        }

        .btn:hover {
            opacity: 1;
        }

        article, aside, figcaption, figure, footer, header, hgroup, main, nav, section{
            display: flex;
        }
        .dropdown-menu{
            z-index: auto;
            --bs-dropdown-link-active-bg: #ffa500;
        }
        .btn:hover {
            color: white;
            background-color: rgb(53, 179, 208);
            border:none;
        }


        .uploaded-item {
            width: 120px; /* Adjust as needed */
            height: 100px; /* Adjust as needed */
            object-fit: cover; /* Ensures the aspect ratio is maintained */
        }



        .uploaded-item {
            margin: 3.5px;
        }


        /* Style for the delete icon */


        /* Style for the uploaded item container */
        .uploaded-item-container {
            position: relative;
            display: inline-block;
            margin-right: 10px;
            margin-bottom: 10px;
        }




        .poll-container {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }

        .poll-container h2 {
            margin-bottom: 20px;
        }

        .poll-container form {
            margin-bottom: 20px;
        }

        #results {
            margin-top: 20px;
        }

        .links a, .short-links a{
            display: flex;
            align-items: center;
            text-decoration: none;
            margin-top: 36px; /*i change*/
            color: white;
            width: fit-content;
        }

        .left-sidebar{
            flex-basis: 33%;  /*i change*/
            position: fixed;
            top: 80px; /*i change*/
            align-self: flex-start;
        }
        nav{
            padding: 18px 5%;
        }

      /*working code*/
       

       /*Spinner loading start*/
        @keyframes l7 {
            to {
                transform: rotate(.5turn);
            }
        }



        .spinner-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px; /* Adjust width as needed */
            height: 200px; /* Adjust height as needed */
            background-color: #FEFDED; /* Slightly opaque white background */
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            border-radius: 10px; /* Rounded corners for better aesthetics */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Add a slight shadow for depth */
            z-index: 1000;
            display: none;
        }

        .spinner {
            width: 50px;
            aspect-ratio: 1;
            --_c: no-repeat radial-gradient(farthest-side, #25b09b 92%, #0000);
            background:
                    var(--_c) top,
                    var(--_c) left,
                    var(--_c) right,
                    var(--_c) bottom;
            background-size: 12px 12px;
            animation: l7 1s infinite;
        }

        .uploading-text {
            margin-top: 10px;
            font-size: 16px;
            color: #333;
        }

        /*Spinner Loading end*/



        .comment {
            position: absolute;
            z-index: 999; /* Ensure the modal is above the overlay */

        }


        #fullSizeImageModal .modal-dialog {
            max-width: 50%; /* Adjust the width as needed */
        }

        #fullSizeImageModal .modal-content {
            border: none; /* Remove border if desired */
            border-radius: 0; /* Remove border radius if desired */
        }

        #google_translate_element {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }

        /*For Guideline View in Home Page*/
        #guidelineModal .modal-header {
            background-color: #369;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 50px;
            border-bottom: 2px solid black;
            font-size: 20px;
             border-top-right-radius: 2px;
            border-top-left-radius: 2px;


        }
        #guidelineModal .modal-footer{
            border-top: 2px solid #ffffff;
            display: flex;
            justify-content: center;
        }
        .header {
            text-align: center;
            width: 100%;
            color: white;
        }
        #guidelineModal .modal-body{
            height: 50px;
        }

        .guidelinePhoto {
            display: block;
            margin: 10px auto;
            max-width: 80%;
            max-height: 80%;
            width: auto;
            height: auto;
        }

        .agree {
            border: 2px solid black;
            color: white;
            background-color: #369;
            height: 25%;
            width: 25%;
            border-radius: 10px;

        }
        .agree:hover {
            border-color: black;
            background-color: #1f4a72;
            color: #ffffff;
        }

        .description-cell {
            max-width: 200px;
            word-wrap: break-word; /* Break long words and wrap onto the next line */
        }
        .table-container {
            max-width: 80%; /* Adjust this value as needed */
            margin-right: 20%; /* Center the table horizontally */
        }

        .guidelineDescription{
            word-wrap: break-word;
            /*margin: 10px auto;*/
        }
        p {
            margin-top: 0;
            margin-bottom: 1rem;
            margin-left: 10px;
        }

        .modal-custom-size {
            max-width: 45%;
        }

        .modal-backdrop {
            backdrop-filter: blur(1000px); /* Increase the blur intensity */
            -webkit-backdrop-filter: blur(1000px); /* For Safari */
            background-color:black; /* Adjust the background color and opacity */
        }



        .error-message {
            color: red;
            display: none;
        }
        .mb-3 {
            margin-bottom: 0rem !important;
        }






    </style>
</head>
<body>
<div th:replace="~{layouts/menu::menu}"></div>
<!--<div id="google_translate_element"></div>-->
<div class="dat" id="dat">
    <div class="main-div">
        <div class="loader-icon1 loader"></div>
        <div class="loader-icon2 loader"></div>
        <div class="loader-icon3 loader"></div>
        <div class="text">DAT</div>
    </div>
</div>

<div class="container">
    <div th:replace="~{layouts/left-sidebar::left-sidebar}" ></div>
    <input type="hidden" th:value="${user.id}" id="id1">
    <input type="hidden" th:value="${user.name}" id="name">
    <input type="hidden" th:value="${user.role}" id="role">

    <div class="main-content">
        <div id="commentsContainer"></div>
        <div class="content">
            <div class="center">
                <audio id="notification-sound">
                    <source src="../static/assets/audio/noti-sound.mp3" type="audio/mpeg">
                </audio>
                <div class="form-post" style="margin-top: 25px">
                    <div class="form-body">
                        <div class="form-submit" data-target="#form-submit" style="height:50px;box-shadow: 0 8px 16px rgb(77 83 94);">
                            <p style="font-family: math;font-size: 118%;margin-top: 12px;">What's happen?</p>
                        </div>
                        <button type="button" class="btn btn-split btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#exampleModalPoll">
                            Create Poll
                        </button>
                    </div>
                        <audio id="voteSound">
                            <source src="../static/assets/audio/hey-hey-boy-meme.mp3" type="audio/mpeg">
                        </audio>
                    <div id="pollList" class="poll-list"></div>
                    <!--                    poll end-->
                    <div class="appendContent"> </div>
                </div>

<!--                <div class="modal fade" id="fullSizeImageModal" tabindex="-1" aria-hidden="true">-->
<!--                    <div class="modal-dialog modal-dialog-centered modal-lg"> &lt;!&ndash; Added modal-lg for larger size &ndash;&gt;-->
<!--                        <div class="modal-content" style="margin-left: -24px;width: 800px;">-->
<!--                            <div class="modal-body p-0">-->
<!--                                <button type="button" class="btn-close position-absolute top-0 end-0 m-2" data-bs-dismiss="modal" aria-label="Close" style="background-color: white"></button>-->
<!--                                <img id="fullSizeImage" src="" alt="Full Size Image" class="w-100" style="height: 500px;">-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
                <div class="modal fade" id="fullSizeImageModal" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-lg">
                        <!-- Added modal-lg for larger size -->
                        <div class="modal-content" style="margin-left: -24px;width: 800px;">
                            <div class="modal-body p-0 position-relative">
                                <button type="button" class="btn-close position-absolute top-0 end-0 m-2" data-bs-dismiss="modal" aria-label="Close" style="background-color: white"></button>
                                <img id="fullSizeImage" src="" alt="Full Size Image" class="w-100" style="height: 500px;">
                                <button id="downloadImageBtn" class="btn btn-primary position-absolute bottom-0 end-0 m-2" style="background-color: rgba(255, 255, 255, 0.7); border: none; padding: 10px 20px;"><i class="fas fa-download" style="color:black;"></i> </button>
                            </div>
                        </div>
                    </div>
                </div>





                <!-- NEW POST modal Start -->
                <div class="overlay"></div>
                <div class="comment">
                    <div class="comment-box" style="margin-left: 1px;width: 590px;margin-top: 131px;">
                        <div class="comment-header">
                            <h3>Create Post</h3>
                            <i class="fas fa-times"></i>
                        </div>
                        <form id="userForm">
                            <input type="hidden" value="0" id="groupId">
                            <div class="comment-body">
                                <textarea name="post-body" placeholder="Write anything before submitting to the post bar" id="text" class="mentionable-textarea"></textarea>
                                <div class="uploaded-photos"></div>

                                <div id="image-modal" class="image-modal">
                                    <span class="close-modal" style="margin-right: 342px;margin-top: 91px;z-index: 99"><i class="fa-solid fa-circle-xmark" style="color: #FFFFFF;"></i></span>
                                    <img class="modal-content" id="full-image">
                                </div>

                            </div>
                            <div class="comment-bottom">
                                <div class="icon">
                                    <label for="multipartFile">
                                        <i class="fas fa-photo-video"></i>
                                        <input type="file" name="multipartFile" id="multipartFile" accept="image/*, video/*" multiple>
                                    </label>
<!--                                    <select id="isPublic">-->
<!--                                        <option value="public"><i class="fa-solid fa-earth-americas fa-lg" style="color: #000000;"></i>Public</option>-->
<!--                                        <option value="private"><i class="fa-solid fa-lock" style="color: #000205;"></i>Private</option>-->
<!--                                    </select>-->
<!--                                    <select id="isPublic" class="icon-select">-->
<!--                                        <option value="public" class="fa fa-earth-americas" > &#xf57d; Public</option>-->
<!--                                        <option value="private" class="fa fa-lock" > &#xf023; Private</option>-->
<!--                                    </select>-->
                                    <div class="custom-select-container">
                                        <div class="custom-select" id="customSelect">
                                            <i class="fas fa-earth-americas"></i> <span>Public</span>
                                        </div>
                                        <div class="custom-options" id="customOptions">
                                            <div data-value="public">
                                                <i class="fas fa-earth-americas"></i> <span>Public</span>
                                            </div>
                                            <div data-value="private">
                                                <i class="fas fa-lock"></i> <span>Private</span>
                                            </div>
                                        </div>
                                    </div>
                                    <select id="isPublic" class="icon-select">
                                        <option value="public">Public</option>
                                        <option value="private">Private</option>
                                    </select>
                                    <div id="error-message" style="color: red; display: none;"></div>

                                    <div class="button-send" style="background-color:rgb(205, 206, 208)">
                                    <button type="button" id="submitButton" class="submitButton" style="border: none;background-color: rgb(205, 206, 208);font-size: 125%;font-family: Math">Create</button>
                                </div>
                            </div>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- Spinner Container -->
                <div id="loading-spinner" class="spinner-container" style="display: none;">
                    <div class="spinner"></div>
                    <div class="uploading-text">Uploading, please wait...</div>
                </div>
                <!-- post create modal end-->

                <!-- start post update -->
                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content" style="margin-top: 131px;width: 590px;margin-left: -86px">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="exampleModalLabel" style="font-family: Math">Post Edit</h1>
                                <button type="button"  class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body" style="background-color: #e0f4f5;">
                                <form>
                                    <input type="hidden" id="groupId1">
                                    <input type="hidden" id="id">
                                    <div class="comment-body">
                                        <textarea name="post-body" placeholder="Write anything before submitting to the post bar" id="text1"></textarea>
                                    </div>
                                    <div class="mb-3" >
                                        <label for="photo" class="form-label" style="font-family: Math">Images</label>
                                        <div id="photo" style=" max-height: 110px;overflow-y: auto;scrollbar-width: none;"></div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="video" class="form-label" style="font-family: Math;">Videos</label>
                                        <div id="video"  style=" max-height: 110px;overflow-y: auto;scrollbar-width: none;" ></div>
                                    </div>
                                    <div class="uploaded-photos" style="max-height: 212px"></div>

                                    <div id="image-modal1" class="image-modal">
                                        <span class="close-modal" style="margin-right: 342px;margin-top: 91px;z-index: 99"><i class="fa-solid fa-circle-xmark" style="color: #FFFFFF;"></i></span>
                                        <img class="modal-content" id="full-image1">
                                    </div>

                                <div class="comment-bottom">
                                    <div class="icon">
                                        <label for="multipartFile1">
                                            <i class="fas fa-photo-video"></i>
                                            <input type="file"    id="multipartFile1" accept="image/*, video/*" multiple>
                                        </label>
<!--                                        <select id="isPublic1">-->
<!--                                            <option value="public">Public</option>-->
<!--                                            <option value="private">Private</option>-->
<!--                                        </select>-->
                                        <div class="custom-select-container1">
                                            <div class="custom-select" id="customSelect1">
                                                <i class="fas fa-earth-americas"></i> <span>Public</span>
                                            </div>
                                            <div class="custom-options1" id="customOptions1">
                                                <div data-value1="public">
                                                    <i class="fas fa-earth-americas"></i> <span>Public</span>
                                                </div>
                                                <div data-value1="private">
                                                    <i class="fas fa-lock"></i> <span>Private</span>
                                                </div>
                                            </div>
                                        </div>
                                        <select id="isPublic1" class="icon-select">
                                            <option value="public">Public</option>
                                            <option value="private">Private</option>
                                        </select>
                                        <div id="error-message1" style="color: red; display: none;"></div>

                                    </div>
                                </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="font-family: Math">Close</button>
                                <button type="button" class="btn btn-primary"  id="submitBtn" style="font-family: Math">Update</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end post update modal -->

                <!-- start share modal form -->
                <div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content" style="margin-top: 131px;width: 590px;margin-left: -86px">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="exampleModalLabel1" style="font-family: Math">Share Post</h1>
                                <button type="button"  class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body" style="background-color: #e0f4f5;">
                                <form>
<!--                                    <input type="hidden" value="0" id="groupId2">-->
                                    <input type="hidden" id="contentId">
                                    <input type="hidden" id="userId">
                                    <div class="comment-body">
                                        <textarea name="post-body" style="font-family: Math" placeholder="Write Caption" id="caption" class="mentionable-textarea"></textarea>
                                    </div>
                                    <select id="isPublic2"  style="height: 36px;margin-left: 7px">
                                        <option value="public">Public</option>
                                        <option value="private">Private</option>
                                    </select>
                                    <div id="error-share" style="color: red; display: none;"></div> <!-- Error message container -->

                                    <input type="hidden" id="share" value="1">

                                    <select id="groupId2" style="border-color: black;height: 35px;">
                                    </select>

                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" style="margin-right: 253px;font-family: Math"  id="submitBtn2">Share</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--end share create modal end-->

                <!--  share modal update 1-->
                <div class="modal fade" id="exampleModal3" tabindex="-1" aria-labelledby="exampleModalLabel2" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content" style="margin-top: 131px;width: 590px;margin-left: -86px">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="exampleModalLabel2" style="font-family: Math">Update Share</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body" style="background-color: #e0f4f5;">
                                <form id="updateShareForm">
                                    <input type="hidden" id="groupId3">
                                    <input type="hidden" id="id3">
                                    <input type="hidden" id="contentId3">
                                    <input type="hidden" id="userId3">
                                    <input type="hidden" id="shareUserId3">
                                    <div class="comment-body">
                                        <textarea name="post-body" style="font-family: Math" placeholder="Write Caption" id="caption4"></textarea>
                                    </div>
                                    <select id="isPublic44" style="height: 36px;margin-left: 7px" >
                                        <option value="public">Public</option>
                                        <option value="private">Private</option>
                                    </select>
                                    <div id="error-shareUpdate" style="color: red; display: none;"></div> <!-- Error message container -->

                                    <input type="hidden" id="share4" value="1">
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" style="margin-right: 253px;font-family: Math" id="submitBtn3">Update</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--share modal update end-->

                <!-- poll create start-->
                <div class="modal fade" id="exampleModalPoll" tabindex="-1" aria-labelledby="exampleModalLabelPoll" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content" style="margin-top: 131px;width: 590px;margin-left: -86px">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="exampleModalLabelPoll" style="font-family: Math">Create a Poll</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body" style="background-color: #e0f4f5;">
                                <form id="pollForm">
                                    <input type="hidden" value="0"  id="groupId4">
                                    <div class="mb-3">
                                        <label for="question" class="form-label" style="margin-left: 5px;font-family: Math">Question</label>
                                        <input type="text" class="form-control" id="question" placeholder="Enter your question here..." style="margin-bottom: 26px;height: 58px;font-family: Math" required>
                                    </div>
                                    <div id="optionsContainer">
                                    </div>
                                    <button type="button" class="btn btn-primary btn-add-option" style="margin-bottom: 25px;margin-top: -16px;font-family: Math" >Add Option</button>
                                    <div class="mb-3">
                                        <label for="endDate" class="form-label" style="font-family: Math">End Date</label>
                                        <input type="datetime-local" class="form-control" id="endDate" style="width: 202px" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="isPublicPoll" class="form-label" style="font-family: Math">Visibility</label>
                                        <select class="form-select" id="isPublicPoll" style="width: 100px">
                                            <option value="public">Public</option>
                                            <option value="private">Private</option>
                                        </select>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="font-family: Math">Close</button>
                                <button type="button" class="btn btn-primary" id="submitBtnPoll" style="font-family: Math">Create Poll</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--poll create end -->

                <!-- kym poll update form start -->
                 <div class="modal fade" id="exampleModalPoll1" tabindex="-1" aria-labelledby="exampleModalLabelPoll1" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content" style="margin-top: 131px;width: 590px;margin-left: -86px">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="exampleModalLabelPoll1"  style="font-family: Math">Poll edit</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body" style="background-color: #e0f4f5;">
                                <form >
                                    <input type="hidden" id="groupId5">
                                    <input type="hidden" id="idOfPoll">
                                    <input type="hidden" id="idOfOptionList">

                                    <div class="mb-3">
                                        <label for="question" class="form-label"  style="margin-left: 5px;font-family: Math">Question</label>
                                        <input type="text" class="form-control" id="question1" style="margin-bottom: 26px;height: 58px;font-family: Math" placeholder="Enter your question here...">
                                    </div>
                                    <div id="optionsContainer1">
                                        <!-- Options will be dynamically added here -->
                                    </div>
                                    <button type="button" class="btn btn-primary btn-add-option1" style="margin-bottom: 25px;margin-top: -16px;font-family: Math">Add Option</button>
                                    <div class="mb-3">
                                        <label for="endDate" class="form-label" style="font-family: Math">End Date</label>
                                        <input type="datetime-local" class="form-control" id="endDate1" style="width: 202px">
                                    </div>
                                    <div class="mb-3">
                                        <label for="isPublicPoll" class="form-label" style="font-family: Math">Visibility</label>
                                        <select class="form-select" id="isPublicPoll1" style="width: 100px">
                                            <option value="public">Public</option>
                                            <option value="private">Private</option>
                                        </select>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="font-family: Math">Close</button>
                                <button type="button" class="btn btn-primary" id="submitBtnPoll1" style="font-family: Math">Update</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- kym  poll update form end -->

            </div>
        </div>



        <div class="modal fade" id="acceptAdmin" tabindex="-1" role="dialog" aria-labelledby="acceptAdminLabel" aria-hidden="true">
            <div class="modal-dialog " role="document">
                <div class="modal-content">
                    <div class="modal-header text-white" style="background-color: #369">
                        <h5 class="modal-title" id="acceptAdminLabel" style="margin-left: 25%">Approve Admin Role</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="background-color: white;">
                        <p style="font-size: 25px">Can you accept the Admin Role?</p>
                    </div>
                    <div class="modal-footer">
                        <input type="submit" id="btn-decline" class="modalBtn btn btn-danger" value="Decline">
                        <input type="submit" class="modalBtn btn btn-success" id="btn-accept" value="Accept">
                    </div>
                </div>
            </div>
        </div>
        <!-- Confirmation modal for role change -->
        <div class="modal fade" id="confirmRoleChangeModal" tabindex="-1" aria-labelledby="confirmRoleChangeModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="confirmRoleChangeModalLabel">Role Change Confirmation</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Your role has been changed. Please confirm if you accept the new role.
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="acceptRoleButton">Accept</button>
                        <button type="button" class="btn btn-secondary" id="rejectRoleButton">Reject</button>
                    </div>
                </div>
            </div>
        </div>


        <!-- User Role Change Reason Display Modal -->
        <div class="modal fade" id="roleChangeDisplayModal" tabindex="-1" role="dialog" aria-labelledby="roleChangeDisplayModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document" style="max-width: 500px; margin: auto; top: 20%;">
                <div class="modal-content" style="border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.3);">
                    <div class="modal-header" style="background-color: #007bff; color: white; border-top-left-radius: 8px; border-top-right-radius: 8px;">
                        <h5 class="modal-title" id="roleChangeDisplayModalLabel">Role Change Notification</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="background-color: transparent; border: none;">
                            <span aria-hidden="true" style="color: white;">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" style="padding: 20px; font-size: 16px; line-height: 1.5;">
                        <p id="roleChangeReasonText"></p>
                    </div>
                    <div class="modal-footer" style="background-color: #f8f9fa; border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" style="background-color: #007bff; border-color: #007bff;">OK</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal for role change message -->
        <div class="modal fade" id="roleChangeMessageModal" tabindex="-1" aria-labelledby="roleChangeMessageModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="roleChangeMessageModalLabel">Role Change</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Your role has been changed, you need to login again.
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" id="roleChangeMessageOkButton">OK</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Spinner modal for logging out -->
        <div class="modal fade" id="logoutSpinnerModal" tabindex="-1" aria-labelledby="logoutSpinnerModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-body text-center">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p>Logging out...</p>
                    </div>
                </div>
            </div>
        </div>



        <!--end-->



<!-- kym  poll option choose create and update start -->
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const optionsContainer = document.getElementById("optionsContainer");
                const addOptionButton = document.querySelector(".btn-add-option");
                const exampleModalPoll = document.getElementById("exampleModalPoll");
                const pollForm = document.getElementById("pollForm");

                addOptionButton.addEventListener("click", function () {
                    const optionCount = optionsContainer.querySelectorAll(".option-item").length + 1;
                    const newOptionItem = createOptionItem(optionCount);
                    optionsContainer.appendChild(newOptionItem);
                });

                optionsContainer.addEventListener("click", function (event) {
                    if (event.target.classList.contains("btn-remove-option")) {
                        event.target.closest(".option-item").remove();
                        updateOptionNumbers();
                    }
                });

                exampleModalPoll.addEventListener('show.bs.modal', function () {
                    resetForm();
                });

                function createOptionItem(optionCount) {
                    const newOptionItem = document.createElement("div");
                    newOptionItem.classList.add("mb-3", "option-item");
                    newOptionItem.style.marginBottom = '1px !important';
                    newOptionItem.innerHTML = `
                <input type="text" class="form-control option-input" placeholder="Option ${optionCount}" style="font-family: Math">
                <button type="button" class="btn btn-danger btn-remove-option" aria-label="Remove option" style="margin-top: -63px;margin-left: 522px">&times;</button>
            `;
                    return newOptionItem;
                }
                function updateOptionNumbers() {
                    const optionItems = optionsContainer.querySelectorAll(".option-item");
                    optionItems.forEach((item, index) => {
                        const input = item.querySelector(".option-input");
                        input.placeholder = `Option ${index + 1}`;
                    });
                }

                function resetForm() {
                    pollForm.reset();  // Reset all form fields
                    optionsContainer.innerHTML = '';
                    optionsContainer.appendChild(createOptionItem(1));
                    optionsContainer.appendChild(createOptionItem(2));
                }

                // Initial options
                // resetOptions();
                resetForm();

            });
            // document.addEventListener("DOMContentLoaded", function () {
            //     const optionsContainer = document.getElementById("optionsContainer");
            //     const addOptionButton = document.querySelector(".btn-add-option");
            //     const pollForm = document.getElementById("pollForm");
            //     const endDateInput = document.getElementById("endDate");
            //
            //     addOptionButton.addEventListener("click", function () {
            //         const optionCount = optionsContainer.querySelectorAll(".option-item").length + 1;
            //         const newOptionItem = createOptionItem(optionCount);
            //         optionsContainer.appendChild(newOptionItem);
            //     });
            //
            //     pollForm.addEventListener('submit', function (event) {
            //         event.preventDefault();
            //         if (validateForm()) {
            //             submitForm();
            //         }
            //     });
            //
            //     endDateInput.addEventListener('input', function () {
            //         const selectedDate = new Date(this.value);
            //         const lastDate = new Date(this.max);
            //         if (selectedDate >= lastDate) {
            //             this.setCustomValidity('End date must be before the last available date.');
            //         } else {
            //             this.setCustomValidity('');
            //         }
            //     });
            //
            //     function createOptionItem(optionCount) {
            //         const newOptionItem = document.createElement("div");
            //         newOptionItem.classList.add("mb-3", "option-item");
            //         newOptionItem.style.marginBottom = '1px !important';
            //         newOptionItem.innerHTML = `
            //     <input type="text" class="form-control option-input" placeholder="Option ${optionCount}" style="font-family: Math">
            //     <button type="button" class="btn btn-danger btn-remove-option" aria-label="Remove option" style="margin-top: -63px;margin-left: 522px">&times;</button>
            // `;
            //         return newOptionItem;
            //     }
            //
            //     function validateForm() {
            //         const question = document.getElementById('question').value.trim();
            //         const options = optionsContainer.querySelectorAll('.option-input');
            //         const endDate = endDateInput.value.trim();
            //
            //         if (question === '') {
            //             alert('Please enter a question.');
            //             return false;
            //         }
            //
            //         if (options.length < 2) {
            //             alert('Please add at least two options.');
            //             return false;
            //         }
            //
            //         if (endDate === '') {
            //             alert('Please select an end date.');
            //             return false;
            //         }
            //
            //         return true;
            //     }
            //
            //     function submitForm() {
            //         // Implement form submission logic here
            //         console.log('Form submitted successfully');
            //         // Close the modal
            //         $('#exampleModalPoll').modal('hide');
            //     }
            // });
        </script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const optionsContainer = document.getElementById("optionsContainer1");
                const addOptionButton = document.querySelector(".btn-add-option1");

                addOptionButton.addEventListener("click", function () {
                    const optionCount = optionsContainer.querySelectorAll(".option-item").length + 1;
                    const newOptionItem = createOptionItem(optionCount);
                    optionsContainer.appendChild(newOptionItem);
                });

                optionsContainer.addEventListener("click", function (event) {
                    if (event.target.classList.contains("btn-remove-option")) {
                        const parentOptionItem = event.target.closest(".option-item");
                        if (parentOptionItem.classList.contains("new-option")) {
                            parentOptionItem.remove();
                            updateOptionNumbers();
                        } else {
                            console.log("Old options cannot be removed.");
                        }
                    }
                });

                function createOptionItem(optionCount) {
                    const newOptionItem = document.createElement("div");
                    newOptionItem.classList.add("mb-3", "option-item", "new-option");
                    newOptionItem.innerHTML = `
                <input type="text" class="form-control option-input1" placeholder="Option ${optionCount}" style="font-family: Math">
                <button type="button" class="btn btn-danger btn-remove-option" aria-label="Remove option" style="margin-top: -63px;margin-left: 522px">&times;</button>
            `;
                    return newOptionItem;
                }

                function updateOptionNumbers() {
                    const optionItems = optionsContainer.querySelectorAll(".option-item");
                    optionItems.forEach((item, index) => {
                        const input = item.querySelector(".option-input1");
                        input.placeholder = `Option ${index + 1}`;
                    });
                }


                //swm
                const tribute = new Tribute({
                    values: (text, cb) => {
                        fetch(`/user/search?q=${text.replace(/\s+/g, '')}`)
                            .then(response => response.json())
                            .then(users => {
                                if (users.length === 0) {
                                    cb([]);
                                } else {
                                    cb(users.map(user => ({
                                        key: user.key,
                                        value: user.value,
                                        userId: user.userId
                                    })));
                                }
                            })
                            .catch(error => {
                                console.error('Error fetching user data:', error);
                                cb([]);
                            });
                    },
                    selectTemplate: function(item) {
                        if (typeof item === 'undefined') return null;
                        return `@${item.original.value}`;
                    },
                    menuItemTemplate: function(item) {
                        return `<li data-user-id="${item.original.userId}">@${item.original.value}</li>`;
                    }
                });

                const postCreateTextarea = document.getElementById('text');
                tribute.attach(postCreateTextarea);


                const shareCaptionTextarea = document.getElementById('caption');
                tribute.attach(shareCaptionTextarea);
            });
        </script>
<!-- kym poll option choose create and update end -->




        <!--Post Delete Modal-->
        <div class="modal fade" id="deletePostModal" tabindex="-1" aria-labelledby="deleteConfirmationModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content" style="margin: 250px -43px">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deletePostModalLabel">Confirm Deletion</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Are you sure you want to move trash to this post?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" id="confirmDeletePostButton">Delete</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="saveModal" tabindex="-1" aria-labelledby="saveModalLabel" aria-hidden="true">
            <div class="modal-dialog" style="margin-right: 34.5%;">
                <div class="modal-content" style="margin: 250px -43px">
                    <div class="modal-header">
                        <h5 class="modal-title" id="saveModalLabel">Confirm Saving</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Are you sure you want to save this post?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirmSavePostButton">Save</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Success Modal -->
        <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" style="margin-right: 621px">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="successModalLabel">Success!</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Content saved successfully.
                    </div>
                </div>
            </div>
        </div>

        <!--Post Delete Modal-->
        <!--Poll Delete Modal-->
        <div class="modal fade" id="deletePollModal" tabindex="-1" aria-labelledby="deleteConfirmationModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content" style="margin: 250px -43px">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deletePollModalLabel">Confirm Deletion</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Are you sure you want to delete this poll?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" id="confirmDeletePollButton" >Delete</button>
                    </div>
                </div>
            </div>
        </div>
        <!--poll Delete Modal-->
        <!--share Delete Modal-->
        <div class="modal fade" id="deleteShareModal" tabindex="-1" aria-labelledby="deleteConfirmationModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content" style="margin: 250px -43px">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteShareModalLabel">Confirm Deletion</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Are you sure you want to delete this share?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" id="confirmDeleteShareButton" >Delete</button>
                    </div>
                </div>
            </div>
        </div>
        <!--share Delete Modal-->


        <!-- Start Guideline Modal -->
        <div class="modal fade" id="guidelineModal" tabindex="-1" role="dialog" aria-labelledby="guidelineModalLabel" aria-hidden="true" data-bs-backdrop="static" style="background-color:rgba(82,82,82,0.93); ">
            <div class="modal-dialog modal-custom-size modal-dialog-centered" role="document">
                <div class="modal-content" style="border: 3px solid black;">
                    <div class="modal-header">
                        <b>
                            <div class="header" id="guideline-title"></div>
                        </b>
                    </div>
                    <img class="guidelinePhoto" id="guideline-photo" src="" alt="Guideline Photo">
                    <div class="paragraph-wrapper" style="width: 85%;margin-left: 10%;">
                        <span class="paragraph"  style="word-wrap: break-word;cursor: pointer"  th:data-description="${guideline.description}" th:text="${guideline.description}"></span>
                        <span class="read-more-span" style="display: none;color: #369;font-weight: bold;font-size: 20px">Read More...</span>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="agree" id="agreeBtn">Accept</button>
                        <button type="button" class="agree" id="cancelBtn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
<!-- End Guideline Modal -->
        <!-- Modal -->
        <div class="modal fade" id="votersModal" tabindex="-1" aria-labelledby="votersModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" style="margin-top: -10px">
                <div class="modal-content" style="margin-right: 90px">
                    <div class="modal-header">
                        <h5 class="modal-title" id="votersModalLabel">Voters</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="votersModalBody" style="margin-left: 28px; max-height: 375px; overflow-y: auto;">
                        <!-- Voter information will be displayed here -->
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>




        <div class="modal fade" id="viewEventModal" tabindex="-1" role="dialog" aria-labelledby="viewEventModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" style="margin-right: 615px;">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewEventModalLabel">Event Details</h5>
<!--                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">-->
<!--                        <span aria-hidden="true">&times;</span>-->
<!--                    </button>-->
                </div>
                <div class="modal-body">
                    <div id="viewEventContent">

                        <div class="mb-3 row justify-content-center">
                            <div class="col-8 align-self-center">
                                <span id="viewPhoto1"></span>
                                <img id="image" src="#" alt="Image Preview" style="height: 180px;width: 340px;border-radius: 12px;object-fit: cover;margin-left: -23px">
                            </div>
                        </div>

                        <div class="mb-3 row">
                            <label for="viewContent" class="col-4 col-form-label" style="font-family: Math;margin-top: 39px"><i class="fas fa-align-left"></i>&nbsp;Content</label>
                            <div class="col-8 align-self-center">
                                <span id="viewContent"></span>
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <label for="viewStartDate" class="col-4 col-form-label" style="font-family: Math"> <i class="fas fa-calendar-alt"></i>&nbsp;Start Date</label>
                            <div class="col-8 align-self-center" style="margin-top: 2px">
                                <span id="viewStartDate"></span>
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <label for="viewEndDate" class="col-4 col-form-label" style="font-family: Math">  <i class="fas fa-calendar-check"></i>&nbsp;End Date</label>
                            <div class="col-8 align-self-center" style="margin-top: 2px">
                                <span id="viewEndDate"></span>
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <label for="viewEventDetails" class="col-4 col-form-label" style="font-family: Math"> <i class="fas fa-info-circle"></i>&nbsp;Event Details</label>
                            <div class="col-8 align-self-center" style="margin-top: 2px">
                                <span id="viewEventDetails"></span>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div th:replace="~{layouts/right-sidebar::right-sidebar}"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.4/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script th:src="@{/static/assets/js/singlechat.js}" crossorigin="anonymous"></script>
<script th:src="@{/static/assets/js/right-sidebar.js}" crossorigin="anonymous"></script>

<script src="https://kit.fontawesome.com/a076d05399.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tributejs/dist/tribute.js"></script>
<script src="../static/assets/js/search.js"></script>
<script th:src="@{/static/assets/js/kym/post.js}"></script>
<script th:src="@{/static/assets/js/kym/poll.js}"></script>



<script>
        //swm
        const tribute = new Tribute({
            values: (text, cb) => {
                fetch(`/user/search?q=${text.replace(/\s+/g, '')}`)
                    .then(response => response.json())
                    .then(users => {
                        if (users.length === 0) {
                            cb([]);
                        } else {
                            cb(users.map(user => ({
                                key: user.key,
                                value: user.value,
                                userId: user.userId
                            })));
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching user data:', error);
                        cb([]);
                    });
            },
            selectTemplate: function(item) {
                if (typeof item === 'undefined') return null;
                return `@${item.original.value}`;
            },
            menuItemTemplate: function(item) {
                return `<li data-user-id="${item.original.userId}">@${item.original.value}</li>`;
            }
        });

        const postCreateTextarea = document.getElementById('text');
        tribute.attach(postCreateTextarea);


        const shareCaptionTextarea = document.getElementById('caption');
        tribute.attach(shareCaptionTextarea);

</script>

<!--Cancel Guideline-->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        document.getElementById("cancelBtn").addEventListener("click", function() {
            console.log("Cancel button clicked");
            window.location.href = "http://localhost:8080/login";
        });
    });
</script>
<!--Cancel Guideline-->

<!-- Cancel and Agree Guideline-->
<script th:inline="javascript">
    $(document).ready(function() {
        $('#agreeBtn').click(function () {
            $('#guidelineModal').modal('hide');

            $.ajax({
                url: '/updateGuidelineSeen',
                type: 'POST',
                success: function (response) {
                    if (response === 'success') {
                        console.log('GuidelineSeen updated successfully.');
                    } else {
                        console.error('Error updating GuidelineSeen:', response);
                    }
                },
                error: function (xhr, status, error) {
                    console.error('Error updating GuidelineSeen:', error);
                }
            });
        });


        $(document).ready(function () {
            var userRole = /*[[${user.role}]]*/ null;

            if (userRole === 'User') {
                var guideline = /*[[${guideline}]]*/ null;
                if (guideline && guideline.guidelineSeen === false) {
                    $('#guidelineModal').modal('show');
                    $('#guideline-title').text(guideline.title);
                    $('#guideline-description').text(guideline.description);
                    $('#guideline-photo').attr('src', guideline.photo);
                }
            }
        });

        // Check for user details and show reason modal if needed
        fetch('/user/me')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(user => {
                if (user && user.id) {
                    var reasonModalSeenKey = 'reasonModalSeen_' + user.id;
                    var reasonModalSeen = localStorage.getItem(reasonModalSeenKey);

                    if (user.reason && reasonModalSeen !== 'true') {
                        showRoleChangeReasonModal(user.reason);
                        localStorage.setItem(reasonModalSeenKey, 'true');
                    }

                    if (user.accept === false && user.pendingRole === 'Admin') {
                        $('#acceptAdmin').modal('show');
                    }
                }
            })
            .catch(error => {
                console.error('Error fetching user data:', error);
            });

// Show role change reason modal
        function showRoleChangeReasonModal(reason) {
            document.getElementById('roleChangeReasonText').textContent = reason;
            $('#roleChangeDisplayModal').modal('show');
            $('#roleChangeDisplayModal').on('hidden.bs.modal', function () {
                showRoleChangeMessageModal();
            });
        }

// Show role change message modal
        function showRoleChangeMessageModal() {
            $('#roleChangeMessageModal').modal('show');
            $('#roleChangeMessageOkButton').on('click', function () {
                $('#roleChangeMessageModal').modal('hide');
                showLogoutSpinnerModal();
            });
        }

// Show logout spinner modal
        function showLogoutSpinnerModal() {
            $('#logoutSpinnerModal').modal('show');
            setTimeout(function () {
                window.location.href = '/logout';
            }, 2000);
        }
        const user = /*[[${user}]]*/ null;
        console.log('userId :' + user.id);

// Event listener for accepting admin role
        document.getElementById('btn-accept').addEventListener('click', function () {

            var staffId = user.id;
            acceptPendingRole(staffId, 'Admin');
            showRoleChangeMessageModal();
        });

// Event listener for declining admin role
        document.getElementById('btn-decline').addEventListener('click', function () {
            var staffId = user.id;
            declinePendingRole(staffId);
        });

// Function to accept pending role
        function acceptPendingRole(staffId, role) {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'http://localhost:8080/user/acceptRole');
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onload = function () {
                if (xhr.status === 200) {
                    console.log('User role accepted');
                    $('#acceptAdmin').modal('hide');
                } else {
                    console.error('Error accepting user role');
                }
            };
            xhr.onerror = function () {
                console.error('Network error occurred');
            };

            var data = {
                staffId: staffId,
                role: role
            };

            xhr.send(JSON.stringify(data));
        }
        function declinePendingRole(staffId) {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'http://localhost:8080/user/declineRole');
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onload = function () {
                if (xhr.status === 200) {
                    console.log('User role declined');
                    $('#acceptAdmin').modal('hide');
                } else {
                    console.error('Error declining user role');
                }
            };
            xhr.onerror = function () {
                console.error('Network error occurred');
            };

            var data = {
                staffId: staffId
            };

            xhr.send(JSON.stringify(data));
        }
    })



</script>
<!--Char Char-->

<!-- kym now-->
<script>
    document.getElementById('customSelect').addEventListener('click', function() {
        const options = document.getElementById('customOptions');
        options.style.display = options.style.display === 'block' ? 'none' : 'block';
    });

    document.querySelectorAll('.custom-options div').forEach(function(option) {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-value');
            const select = document.getElementById('isPublic');
            const display = document.getElementById('customSelect');

            select.value = value;
            display.innerHTML = this.innerHTML;

            document.getElementById('customOptions').style.display = 'none';
        });
    });

    document.addEventListener('click', function(event) {
        if (!document.querySelector('.custom-select-container').contains(event.target)) {
            document.getElementById('customOptions').style.display = 'none';
        }
    });

</script>


<script>
    document.getElementById('customSelect1').addEventListener('click', function() {
        const options = document.getElementById('customOptions1');
        options.style.display = options.style.display === 'block' ? 'none' : 'block';
    });

    document.querySelectorAll('.custom-options1 div').forEach(function(option) {
        option.addEventListener('click', function() {
            const value = this.getAttribute('data-value1');
            const select = document.getElementById('isPublic1');
            const display = document.getElementById('customSelect1');

            select.value = value;
            display.innerHTML = this.innerHTML;

            document.getElementById('customOptions1').style.display = 'none';
        });
    });

    document.addEventListener('click', function(event) {
        if (!document.querySelector('.custom-select-container1').contains(event.target)) {
            document.getElementById('customOptions1').style.display = 'none';
        }
    });

</script>
<!--kym now end-->

<!-- Place the JavaScript code in a script tag -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Find all images and attach click event listener to show full size image
        const images = document.querySelectorAll('.full-size-image-trigger');
        images.forEach(image => {
            image.addEventListener('click', function() {
                const imageUrl = this.src;
                const modalImage = document.getElementById('fullSizeImage');
                modalImage.src = imageUrl;
                $('#fullSizeImageModal').modal('show');
            });
        });
    });
</script>
<script type="text/javascript">
    function googleTranslateElementInit() {
        new google.translate.TranslateElement({
            pageLanguage: 'en',
            includedLanguages: 'en,ja,zh-CN,hi,my,es,fr,de,ru,ar,pt,bn,ko,it,tr,vi,pl,th,nl,sv,da,fi,no,el,he,hu,cs,ro,sk,uk,id'
        }, 'google_translate_element');
    }
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<!--For Guideline  Read more-->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var paragraphs = document.querySelectorAll('.paragraph');
        paragraphs.forEach(function(paragraph) {
            var fullText = paragraph.innerHTML;
            var maxLength = 205;
            if (fullText.length > maxLength) {
                var truncatedText = fullText.substring(0, maxLength);
                paragraph.innerHTML = truncatedText;
                var readMoreSpan = paragraph.nextElementSibling;
                readMoreSpan.style.display = 'inline';
                readMoreSpan.addEventListener('click', function() {
                    if (readMoreSpan.innerText === 'Read More...') {
                        paragraph.innerHTML = fullText;
                        readMoreSpan.innerText = 'Read Less...';
                    } else {
                        paragraph.innerHTML = truncatedText;
                        readMoreSpan.innerText = 'Read More...';
                    }
                });
            }
        });
    });
</script>
<!--For Guideline  Read more-->

<!-- delete -->
<script>
    var deletePostModal = document.getElementById('deletePostModal');
    deletePostModal.addEventListener('show.bs.modal', function (event) {
        // Button that triggered the modal
        var button = event.relatedTarget;
        // Extract info from data-* attributes
        var contentId = button.getAttribute('data-content-id');
        // Update the modal's delete button to pass this ID to deleteUser function
        var confirmDeletePostButton = document.getElementById('confirmDeletePostButton');
        confirmDeletePostButton.setAttribute('onclick', 'deleteUser(' + contentId + ')');
    });

    document.addEventListener('DOMContentLoaded', function () {
        var savePostModal = document.getElementById('saveModal'); // Ensure the ID matches the HTML
        savePostModal.addEventListener('show.bs.modal', function (event) {
            // Button that triggered the modal
            var button = event.relatedTarget;
            // Extract info from data-* attributes
            var contentId = button.getAttribute('data-content-id');
            // Update the modal's save button to pass this ID to saveUser function
            var confirmSavePostButton = document.getElementById('confirmSavePostButton');
            confirmSavePostButton.setAttribute('onclick', 'saveUser(' + contentId + ')');
        });
    });


    var deleteShareModal = document.getElementById('deleteShareModal');
    deleteShareModal.addEventListener('show.bs.modal', function (event) {
        // Button that triggered the modal
        var button = event.relatedTarget;
        // Extract info from data-* attributes
        var shareId = button.getAttribute('data-share-id');
        // Update the modal's delete button to pass this ID to deleteUser function
        var confirmDeleteShareButton = document.getElementById('confirmDeleteShareButton');
        confirmDeleteShareButton.setAttribute('onclick', 'deleteShare(' + shareId + ')');
    });

 var deletePollModal = document.getElementById('deletePollModal');
     deletePollModal.addEventListener('show.bs.modal', function (event) {
         // Button that triggered the modal
         var button = event.relatedTarget;
         // Extract info from data-* attributes
        var pollId = button.getAttribute('data-poll-id');
         var pollOptionId = button.getAttribute('data-poll-option');
         // Update the modal's delete button to pass this ID to deleteUser function
         var confirmDeletePollButton = document.getElementById('confirmDeletePollButton');
         confirmDeletePollButton.setAttribute('onclick', 'deletePoll(' + pollId + ','+pollOptionId+')');
     });

</script>

<script>
    // Hide the overlay after 3 seconds
    window.addEventListener('load', () => {
        setTimeout(() => {
            const dat = document.getElementById('dat');
            dat.style.opacity = '0';
            dat.style.pointerEvents = 'none';
            setTimeout(() => {
                dat.style.display = 'none';
            }, 500); // Match the transition duration
        }, 500);
    });
</script>

<script>
    $(document).ready(function() {
        $('.copy-link').click(function() {
            const postUrl = $(this).data('post-url');
            window.location.href = postUrl;
        });
    });
</script>
</body>
</html>







